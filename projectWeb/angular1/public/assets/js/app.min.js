"use strict";angular.module("appPrincipal",["ui.router","ngAnimate","toastr"]);
"use strict";angular.module("appPrincipal").controller("AuthCtrl",["$location","msgs","auth",function(o,t,n){var r=this;r.loginMode=!0,r.changeMode=function(){return r.loginMode=!r.loginMode},r.login=function(){n.login(r.user,function(n){return n?t.addError(n):o.path("/")})},r.signup=function(){n.signup(r.user,function(n){return n?t.addError(n):o.path("/")})},r.getUser=function(){return n.getUser()},r.logout=function(){n.logout(function(){return o.path("/")})}}]);
"use strict";angular.module("appPrincipal").constant("consts",{appName:"MEAN - Primeira Aplicação",version:"1.0",owner:"Carlos",year:"2017",site:"https://github.com/carloscacho",apiUrl:"http://localhost:3010/api",oapiUrl:"http://localhost:3010/oapi",userKey:"_primeira_app_user"}).run(["$rootScope","consts",function(o,a){o.consts=a}]);
"use strict";angular.module("appPrincipal").config(["$stateProvider","$urlRouterProvider","$httpProvider",function(t,a,o){t.state("dashboard",{url:"/dashboard",templateUrl:"dash/dashboard.html"}).state("finance",{url:"/finance?page",templateUrl:"finance/tabs.html"}),o.interceptors.push("handleResponseError")}]).run(["$rootScope","$http","$location","$window","auth",function(t,r,i,l,a){function o(){var o=a.getUser(),e="/auth.html",n=l.location.href.includes(e);o||n?o&&!o.isValid&&a.validateToken(o.token,function(t,a){a?(o.isValid=!0,r.defaults.headers.common.Authorization=o.token,n?l.location.href="/":i.path("/dashboard")):l.location.href=e}):l.location.href=e}o(),t.$on("$locationChangeStart",o)}]);
"use strict";angular.module("appPrincipal").controller("DashboardCtrl",["$http",function(t){var r=this;r.getSummary=function(){t.get("http://localhost:3010/api/financeSummary").then(function(t){var a=t.data,t=a.credit,t=void 0===t?0:t,a=a.debt,a=void 0===a?0:a;r.credit=t,r.debt=a,r.total=t-a})},r.getSummary()}]);
"use strict";angular.module("appPrincipal").controller("FinanceCtrl",["$http","$location","msgs","tabs",function(a,n,c,t){var i=this,s="http://localhost:3010/api/finance";i.refresh=function(){var e=parseInt(n.search().page)||1;a.get("".concat(s,"?skip=").concat(10*(e-1),"&limit=10")).then(function(e){i.finance={credits:[{}],debts:[{}]},i.finances=e.data,i.calcularValues(),a.get("".concat(s,"/count")).then(function(e){i.pages=Math.ceil(parseInt(e.data.value)/10),t.show(i,{tabList:!0,tabCreate:!0})})})},i.create=function(){console.log(i.finance),a.post(s,i.finance).then(function(e){i.refresh(),c.addSuccess("Operação Realizada com Sucesso")}).catch(function(e){c.addError(e.data.errors)})},i.showTabUpdate=function(e){i.finance=e,i.calcularValues(),t.show(i,{tabUpdate:!0})},i.showTabDelete=function(e){i.finance=e,i.calcularValues(),t.show(i,{tabDelete:!0})},i.delete=function(){var e="".concat(s,"/").concat(i.finance._id);a.delete(e,i.finance).then(function(e){i.refresh(),c.addSuccess("Operação de exclusão realizada com Sucesso!")}).catch(function(e){c.addError(e.data.errors)})},i.update=function(){var e="".concat(s,"/").concat(i.finance._id);a.put(e,i.finance).then(function(e){i.refresh(),c.addSuccess("Operação de alteração realizada com Sucesso!")}).catch(function(e){c.addError(e.data.errors)})},i.btnAddCredit=function(e){i.finance.credits.splice(e+1,0,{})},i.btnCloneCredit=function(e,a){var n=a.name,a=a.value;i.finance.credits.splice(e+1,0,{name:n,value:a}),i.calcularValues()},i.btnDeleteCredit=function(e){1<i.finance.credits.length&&(i.finance.credits.splice(e,1),i.calcularValues())},i.btnAddDebt=function(e){i.finance.debts.splice(e+1,0,{})},i.btnCloneDebt=function(e,a){var n=a.name,c=a.value,a=a.status;i.finance.debts.splice(e+1,0,{name:n,value:c,status:a}),i.calcularValues()},i.btnDeleteDebt=function(e){1<i.finance.debts.length&&(i.finance.debts.splice(e,1),i.calcularValues())},i.calcularValues=function(){i.credit=0,i.debt=0,i.finance&&(i.finance.credits.forEach(function(e){e=e.value;i.credit+=!e||isNaN(e)?0:parseFloat(e)}),i.finance.debts.forEach(function(e){e=e.value;i.debt+=!e||isNaN(e)?0:parseFloat(e)}),i.total=i.credit-i.debt)},i.refresh()}]);
"use strict";angular.module("appPrincipal").component("authField",{bindings:{id:"@",label:"@",type:"@",grid:"@",icon:"@",model:"=",placeholder:"@",hide:"<"},controller:function(){var n=this;this.$onInit=function(){n.iconClasses="glyphicon glyphicon-".concat(n.icon," form-controlfeedback")}},template:'\n            <div class="form-group has-feedback">\n                <input ng-model="$ctrl.model" id="{{ $ctrl.id }}" class="form-control"\n                type="{{ $ctrl.type }}" placeholder="{{ $ctrl.placeholder }}"\n                ng-hide="$ctrl.hide" />\n                <span class="{{ $ctrl.iconClasses }}"></span>\n            </div>\n        '});
"use strict";angular.module("appPrincipal").component("contentHeader",{bindings:{name:"@",small:"@"},template:'\n    <section class="content-header">\n      <h1>{{$ctrl.name}} <small> {{$ctrl.small}} </small></h1>\n    </section>\n    '});
"use strict";angular.module("appPrincipal").component("field",{bindings:{id:"@",label:"@",grid:"@",placeh:"@",type:"@",model:"=",readonly:"<"},controller:["gridSystem",function(l){var n=this;this.$onInit=function(){n.gridClasses=l.toCssClasses(n.grid)}}],template:'\n    <div class="{{ $ctrl.gridClasses}}">\n      <div class="form-group">\n        <label for="{{$ctrl.id}}">{{$ctrl.label}}</label>\n        <input type="{{$ctrl.type}}" name="{{$ctrl.id}}" id="{{$ctrl.id}}"\n        placeholder="{{$ctrl.placeh}}" class="form-control"\n        ng-model="$ctrl.model" ng-readonly="$ctrl.readonly"/>\n      </div>\n    </div>\n    '});
"use strict";angular.module("appPrincipal").component("paginator",{bindings:{url:"@",pages:"@"},controller:["$location",function(n){this.$onInit=function(){this.numpages=parseInt(this.pages)||1,this.arrayPages=Array(this.numpages).fill(0).map(function(n,t){return t+1}),this.current=parseInt(n.search().page)||1,this.needPagination=1<this.pages,this.hasPrev=1<this.current,this.hasNext=this.current<parseInt(this.pages),this.isCurrent=function(n){return this.current==n}}}],template:'\n            <ul ng-if="$ctrl.needPagination" class="pagination pull-right no-margin">\n\n                <li ng-if="$ctrl.hasPrev" class="paginate_button previous">\n                    <a href="{{ $ctrl.url }}?page={{$ctrl.current - 1}}" >Anterior</a>\n                </li>\n\n                <li ng-class="{active: $ctrl.isCurrent(index)}" ng-repeat="index in $ctrl.arrayPages">\n                    <a href="{{ $ctrl.url }}?page={{ index }}">{{ index }}</a>\n                </li>\n\n\n                <li ng-if="$ctrl.hasNext" class="paginate_button next">\n                    <a href="{{ $ctrl.url }}?page={{$ctrl.current + 1}}" >Próximo</a>\n                </li>\n            </ul>\n        '});
"use strict";angular.module("appPrincipal").component("valueBox",{bindings:{grid:"@",color:"@",value:"@",text:"@",icon:"@"},controller:["gridSystem",function(n){var i=this;this.$onInit=function(){i.gridClass=n.toCssClasses(i.grid)}}],template:'\n      <div class="small-box bg-{{$ctrl.color}}">\n          <div class="inner">\n            <h3>{{$ctrl.value}}</h3>\n            <p> {{$ctrl.text}}</p>\n          </div>\n          <div class="icon">\n            <i class="fa {{$ctrl.icon}}"></i>\n          </div>\n        </div>\n      '});
"use strict";angular.module("appPrincipal").factory("auth",["$http","consts",function(a,e){var n=null;function o(t,n,o){a.post("".concat(e.oapiUrl,"/").concat(t),n).then(function(t){localStorage.setItem(e.userKey,JSON.stringify(t.data)),a.defaults.headers.common.Authorization=t.data.token,o&&o(null,t.data)}).catch(function(t){o&&o(t.data.errors,null)})}function u(t){n=null,localStorage.removeItem(e.userKey),a.defaults.headers.common.Authorization="",t&&t(null)}function l(){return n||(n=JSON.parse(localStorage.getItem(e.userKey)),a.defaults.headers.common.Authorization=n?n.token:null),n}return{signup:function(t,n){o("signup",t,n)},login:function(t,n){o("login",t,n)},logout:u,getUser:l,validateToken:function(t,n){t?a.post("".concat(e.oapiUrl,"/validateToken"),{token:t}).then(function(t){t.data.valid?a.defaults.headers.common.Authorization=l().token:u(),n&&n(null,t.data.valid)}).catch(function(t){n&&n(t.data.errors)}):n&&n("Token inválido.")}}}]);
"use strict";angular.module("appPrincipal").factory("gridSystem",[function(){return{toCssClasses:function(c){var t=c?c.split(" "):[],c="";return t[0]&&(c+="col-xs-".concat(t[0])),t[1]&&(c+=" col-sm-".concat(t[1])),t[2]&&(c+=" col-md-".concat(t[2])),t[3]&&(c+=" col-lg-".concat(t[3])),c}}}]);
"use strict";angular.module("appPrincipal").factory("handleResponseError",["$q","$window","consts",function(e,o,n){return{responseError:function(r){return 403===r.status&&(localStorage.removeItem(n.userKey),o.location.href="/"),e.reject(r)}}}]);
"use strict";angular.module("appPrincipal").factory("msgs",["toastr",function(o){function n(r,n,c){r instanceof Array?r.forEach(function(r){return o[c](r,n)}):o[c](r,n)}return{addSuccess:function(r){n(r,"Sucesso","success")},addError:function(r){n(r,"Erro","error")}}}]);
"use strict";angular.module("appPrincipal").factory("tabs",[function(){return{show:function(t,a){var e=a.tabList,i=void 0!==(b=a.tabCreate)&&b,b=void 0!==(b=a.tabUpdate)&&b,a=void 0!==(a=a.tabDelete)&&a;t.tabList=void 0!==e&&e,t.tabCreate=i,t.tabUpdate=b,t.tabDelete=a}}}]);